■■■■■■■■■■■■■■■■■■■
特定の色のついたセルの行だけ残す　

Ver 2.3.0.0
■■■■■■■■■■■■■■■■■■■

############################
#１、アドインについて
############################
1.機能
　あるセル範囲（単一、一列のみ）のセルの塗りつぶしの色を調べます。
そして、あるセルの塗りつぶしの色が、あらかじめ選択された色でなかった場合、
そのセルが含まれる行全体を非表示、又は削除します。

2.動作確認環境
Macの場合
　OS:Mac OS X 10.3.9
　Excel:Microsoft Excel X for Mac
　※上記以外のバージョンでも動作するかもしれませんが、確認していません。

Windowsの場合
　OS:Windows XP,98
　Excel:Microsoft Excel 2003,97
　※上記以外のバージョンでも動作するかもしれませんが、確認していません。

※このアドインを使用するにはExcelだけでなく、数式エディタも必要です。
数式エディタはExcelもしくはOfficeのインストールCDからインストールできます。

############################
#２、ファイル構成
############################
SCI
　├ReadMe.txt　　　　　　　　　…テキスト形式のヘルプ（このファイルです。）
　├help_select_by_colorindex　　…HTML形式のヘルプ
　└select_by_colorindex.xla　　　　　…アドイン

※このファイルには最低限のことだけ記述しています。
詳細はHTML形式のヘルプを参照するようにしてください。

############################
#３、インストール方法
############################
1.Windowsを使用している方は、
[ツール]メニューの[マクロ]-[セキュリティ]から
Excelのセキュリティレベルを「中」にしてください。

※上記の操作を行うと、ウィルスに対して弱くなるので対策ソフトを入れるなどを
してください。

2.Excelのメニューの[ツール]-[アドイン]からアドインを登録してください。
アドインを登録すると、Excelメニューの[標準]ツールバーの一番左に
[特定の色の付いたセルの行だけ残す]ボタンが追加されます。
ボタンの移動やコピーはExcelメニューの[ツール]-[ユーザー設定]より行ってください。

############################
#４、使用方法
############################
1.[特定の色の付いたセルの行だけ残す]ボタンを押下します。
　画面が表示されます。

############################
#５、画面の説明
############################
1.[対象の範囲:]
　セルの塗りつぶしの色を調べ、行を非表示または削除する際の、色を調べるセル範囲（一列、単一範囲）を指定します。 
2.[色の選択] 
　・カラーパレット（塗りつぶしなし＋56色）
　　残したい色をクリックして、選択状態にします。 
　・[すべて選択]、[すべて解除]
　　[すべて選択]をクリックすると、すべての色を選択状態にし、
　　[すべて解除]をクリックすると、すべての色の選択を解除します。 
　・[選択する色をセルから参照:]
　　セルから色を拾得します。詳細はHTML形式のマニュアルを参照してください。
3.[オプション]
　詳細はHTML形式のマニュアルを参照してください。
4.[このマクロについて]
　このアドインについての情報を見ることができます。 
　・[バージョン]
　　アドイン名と、バージョン情報を見ることができます。 
　・[作成者]
　　このアドインの作成者の名前と、連絡先の情報を見ることができます。 
　・[ヘルプ]
　　HTML形式のマニュアルを見ることができます。 
5.[キャンセル]
　何もせず画面を閉じます。 
6.[非表示にする]、[削除する]
　[対象の範囲:]で選択したセル範囲に含まれるセルの塗りつぶしの色を調べ、
　その色が[色の選択]で選ばれなかった色であった場合、その行を非表示（[非表示にする]をクリックした場合）または、
　削除（[削除する]をクリックした場合）します。
　※注意：実行後、元に戻すことができません。


############################
#６、アンインストール方法
############################
1.Excelのメニューの[ツール]-[アドイン]からアドインを解除してください。
　これにより、[特定の色の付いたセルの行だけ残す]ボタンが削除されます。
2.アドインファイルを削除してください。

############################
#７、前バージョン使用者へ
############################
前のバージョン（マクロ形式）を削除し、このバージョンをインストールしてください。

############################
#８、修正履歴
############################
2.3.0
	マクロ形式からアドイン形式に変更

それ以前
	いろいろ修正していたと思う。

############################
#９、バグ情報
############################
　最新のバグ情報は
http://members3.jcom.home.ne.jp/daruma_kyo/download/bug_select_by_colorindex.html
を参照してください。
　以下はすでに見つかっているバグです。
■１．条件付き書式を使っている場合で、数値に変換できる文字列同士を比較している場合に
正常にセルの色を取得できない事がある。
例えば、
　A1=000、B1=000 ※共に、セルの表示形式は[文字列]とする
でB1にA1と同じときにセルの色を付けると条件付き書式で設定した場合、画面上ではセルに色がつきますが、マクロではそれが無視されます。

原因：条件付き書式で設定した条件式の真偽値をマクロ内で判断しています。そこがバグっています。

■２．アクティブワークブックがない状態
（開いている全てのブックを非表示にした状態（[ウインドウ]メニューの[表示しない]を実行した状態））
でマクロを起動すると、
　　実行時エラー'91':
　　オブジェクト変数またはWithブロック変数が設定されていません。
というエラーがでる

############################
#１０、作成者について
############################
名前：宮崎　崇（みやざき　たかし）
URL： http://members3.jcom.home.ne.jp/daruma_kyo/index.html 
E-mail：daruma_kyo@jcom.home.ne.jp

############################
#１１、注意
############################
このアドインを使ったことによる損害は、このアドインの作成者は負わないものとします。 
このアドインおよびヘルプの著作権は作成者が所有しています。 
個人的に利用する場合を除き、無断で転載、配付等はできません。 


